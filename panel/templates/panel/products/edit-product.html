{% extends 'admin-panel.html' %}
{% load static %}

<!-- Custome-CSS -->
{% block style %}
    <link rel="stylesheet" href="{% static 'css/panel/products/edit-product.css' %}">
{% endblock style %}


{% block content %}

<div class="main-panel">
    <div class="content-wrapper">
        {% if messages %}
            <div class="mx-3">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        <span class="alert-text">{{ message }}</span>
                        <!-- <button type="button" class="btn-close alert-close" data-bs-dismiss="alert"></button> -->
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        <div class="row">
            <div class="col-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title" style="color: rgb(46, 237, 16);">Edit Product | {{ product.product_id }}</h3>
                        
                        <form class="forms-sample" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="form-group">
                                <label for="exampleInputName1">Product name</label>
                                <input type="text" class="form-control" name="product_name" value="{{ product.product_name }}">
                                <input type="hidden" name="product_id" value={{product.id}}>
                            </div>
                            <div class="form-group">
                                <label for="exampleTextarea1">Description</label>
                                <textarea class="form-control" rows="4" name="product_description">{{ product.product_description }}</textarea>
                            </div>
                            <div class="form-group">
                                <label for="exampleInputEmail3">Product price</label>
                                <input type="text" class="form-control" name="product_price" value="{{ product.product_price }}">
                            </div>
                            <div class="form-group">
                                <label>File upload</label>
                                <!-- Hidden file input -->
                                <input type="file" name="product_image" class="file-upload-default" id="fileUpload" style="display:none;">
                                
                                <div class="input-group col-xs-12">
                                    <input type="text" class="form-control file-upload-info" disabled value="{{ product.product_image }}">
                                    <span class="input-group-append">
                                        <button class="file-upload-browse btn btn-primary" type="button">Upload</button>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="exampleSelectGender">Category</label>
                                <select class="form-control" name="category" required>
                                    <option> </option>
			                    	    {% for category in categories %}
                                            <option value="{{ category.id }}"
                                                {% if product and category.id == product.category.id %} selected {% endif %}>
                                                 {{ category.category_name }}
                                            </option>
                                        {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="exampleInputCity1">Stock</label>
                                <input type="text" class="form-control" name="stock" value="{{ product.stock }}">
                            </div>
                            
                            <button type="submit" class="btn btn-primary mr-2">Update</button>
                            <a href="{% url 'admin-panel' %}" class="btn btn-light">Cancel</a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ðŸ”¥ JavaScript Fix -->
<script>
    // when "Upload" button is clicked, trigger hidden file input
    document.querySelector(".file-upload-browse").addEventListener("click", function () {
        document.querySelector("#fileUpload").click();
    });

    // when file is selected, show file name in text field
    document.querySelector("#fileUpload").addEventListener("change", function () {
        let fileName = this.files[0] ? this.files[0].name : "Upload Image";
        document.querySelector(".file-upload-info").value = fileName;
    });
</script>

<!-- Custom js for this page-->
{% block scripts %}
	<script src="{% static 'js/panel/products/edit-products.js' %}"></script>
{% endblock scripts %}

{% endblock content %}